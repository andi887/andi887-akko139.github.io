
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fitur 11 - kelompok</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 16px;
      color: #333;
    }
    .back-btn {
      display: inline-block;
      margin-bottom: 16px;
      color: #2196F3;
      text-decoration: none;
      font-weight: bold;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
    }
    .input-area {
      text-align: center;
      margin: 20px 0;
    }
    input {
      padding: 8px;
      width: 100px;
      font-size: 16px;
      text-align: center;
      margin-right: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      padding: 8px 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover { opacity: 0.9; }
    .result {
      margin-top: 20px;
      background: white;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: none;
    }
    .kamar-box {
      margin-top: 16px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    .kamar-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    .angka {
      word-break: break-all;
      font-family: monospace;
      margin: 8px 0;
      line-height: 1.4;
    }
    .btn-salin {
      background: #2196F3;
      padding: 6px 12px;
      font-size: 14px;
    }
    .action-buttons {
      margin-top: 16px;
      text-align: center;
    }
    .btn-delete {
      background: #f44336;
      margin-left: 8px;
    }
    .btn-edit {
      background: #FF9800;
    }
    #status {
      text-align: center;
      margin: 10px 0;
      min-height: 24px;
      font-weight: bold;
    }
    .success { color: #4CAF50; }
    .error { color: #f44336; }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-btn">← Kembali ke Beranda</a>
    <h2>kelompok</h2>

    <div class="input-area">
      <input type="text" id="input2D" placeholder="Contoh: 12" maxlength="2" />
      <button id="btnCari">Cari</button>
    </div>

    <div id="status"></div>
    <div id="hasil" class="result"></div>

    <div class="action-buttons">
      <button class="btn-edit" id="btnEdit">Edit</button>
      <button id="btnSimpan">Simpan ke Firebase</button>
      <button class="btn-delete" id="btnHapus">Hapus</button>
    </div>
  </div>

  <!-- Firebase SDK (Versi Kompatibel Lama) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // === 1. DATA STATIS (TIDAK BUTUH FIREBASE) ===
    const pasanganKamar = {
      "00":[1,2],"11":[1,3],"22":[2,3],"33":[1,2],"44":[1,3],"55":[2,3],"66":[1,2],"77":[1,3],"88":[2,3],"99":[1,2],
      "01":[1,2],"10":[2,3],"02":[1,3],"20":[1,2],"03":[2,3],"30":[1,3],"04":[1,2],"40":[1,3],"05":[2,3],"50":[1,2],
      "06":[1,3],"60":[2,3],"07":[1,2],"70":[2,3],"08":[2,3],"80":[1,3],"09":[1,3],"90":[1,2],"12":[1,3],"21":[2,3],
      "13":[2,3],"31":[1,2],"14":[1,2],"41":[2,3],"15":[1,3],"51":[1,2],"16":[2,3],"61":[1,3],"17":[1,2],"71":[1,3],
      "18":[1,3],"81":[2,3],"19":[2,3],"91":[1,2],"23":[1,2],"32":[1,3],"24":[2,3],"42":[1,2],"25":[1,3],"52":[2,3],
      "26":[1,2],"62":[1,3],"27":[2,3],"72":[1,2],"28":[1,3],"82":[2,3],"29":[1,2],"92":[1,3],"34":[2,3],"43":[1,2],
      "35":[1,3],"53":[2,3],"36":[1,2],"63":[1,3],"37":[2,3],"73":[1,2],"38":[1,3],"83":[2,3],"39":[1,2],"93":[1,3],
      "45":[2,3],"54":[1,3],"46":[1,2],"64":[2,3],"47":[1,3],"74":[1,2],"48":[2,3],"84":[1,3],"49":[1,2],"94":[2,3],
      "56":[1,3],"65":[1,2],"57":[2,3],"75":[1,3],"58":[1,2],"85":[2,3],"59":[1,3],"95":[1,2],"67":[2,3],"76":[1,3],
      "68":[1,2],"86":[1,3],"69":[1,3],"96":[2,3],"78":[2,3],"87":[1,2],"79":[1,3],"97":[2,3],"89":[1,2],"98":[1,3]
    };

    const shioKeKamar = {1:1,4:1,7:1,10:1, 2:2,5:2,8:2,11:2, 3:3,6:3,9:3,12:3};
    const kamar2D = {1:[],2:[],3:[]};
    for (let n = 0; n <= 99; n++) {
      const num = String(n).padStart(2, '0');
      const shio = (n % 12 === 0) ? 12 : (n % 12);
      kamar2D[shioKeKamar[shio]].push(num);
    }

    // === 2. STATE ===
    let currentData = null;
    let currentKey = null;

    // === 3. FUNGSI BANTUAN ===
    function showStatus(text, type) {
      const el = document.getElementById('status');
      el.textContent = text;
      el.className = type;
    }

    function salinTeks(teks) {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(teks).then(() => {
          showStatus("Disalin!", "success");
        });
      } else {
        showStatus("Tidak didukung.", "error");
      }
    }

    // === 4. INISIALISASI UI (JALAN MESKI FIREBASE GAGAL) ===
    document.addEventListener('DOMContentLoaded', () => {
      // Tombol Cari
      document.getElementById('btnCari').addEventListener('click', () => {
        const raw = document.getElementById('input2D').value.trim();
        if (!raw || !/^\d+$/.test(raw) || raw.length > 2) {
          showStatus("Masukkan 1-2 digit angka!", "error");
          return;
        }
        const input = String(raw).padStart(2, '0');
        if (!pasanganKamar[input]) {
          showStatus("Angka tidak valid!", "error");
          return;
        }

        const [k1, k2] = pasanganKamar[input];
        const hasilDiv = document.getElementById('hasil');
        hasilDiv.innerHTML = `
          <div><strong>Pasangan Kamar: ${k1}, ${k2}</strong></div>
          <div class="kamar-box">
            <div class="kamar-title">Kamar ${k1}: shio ${k1 === 1 ? '1,4,7,10' : k1 === 2 ? '2,5,8,11' : '3,6,9,12'}</div>
            <div class="angka" id="angka1">${kamar2D[k1].join('*')}</div>
            <button class="btn-salin" onclick="salinTeks('${kamar2D[k1].join('*')}')">Salin</button>
          </div>
          <div class="kamar-box">
            <div class="kamar-title">Kamar ${k2}: shio ${k2 === 1 ? '1,4,7,10' : k2 === 2 ? '2,5,8,11' : '3,6,9,12'}</div>
            <div class="angka" id="angka2">${kamar2D[k2].join('*')}</div>
            <button class="btn-salin" onclick="salinTeks('${kamar2D[k2].join('*')}')">Salin</button>
          </div>
        `;
        hasilDiv.style.display = 'block';
        currentData = { input, kamar: [k1, k2], waktu: new Date().toISOString() };
        showStatus("Hasil siap.", "success");
      });

      // Edit
      document.getElementById('btnEdit').addEventListener('click', () => {
        if (currentData) {
          document.getElementById('input2D').value = currentData.input;
          showStatus("Edit input, lalu klik Cari.", "success");
        } else {
          showStatus("Tidak ada data.", "error");
        }
      });

      // Simpan & Hapus → akan diisi setelah Firebase siap
      document.getElementById('btnSimpan').addEventListener('click', () => {
        if (window.firebaseReady && currentData) {
          simpanKeFirebase();
        } else {
          showStatus("Firebase belum siap.", "error");
        }
      });

      document.getElementById('btnHapus').addEventListener('click', () => {
        if (window.firebaseReady && currentKey) {
          hapusDariFirebase();
        } else {
          showStatus("Tidak ada data untuk dihapus.", "error");
        }
      });

      // Daftarkan salinTeks ke window
      window.salinTeks = salinTeks;
    });

    // === 5. INISIALISASI FIREBASE (DIPISAH, TIDAK GANGGU UI) ===
    const firebaseConfig = {
      apiKey: "AIzaSyALc-1SYjzRUcB-Ws01rab1mxlmcv2e6dA",
      authDomain: "nomoromosse.firebaseapp.com",
      databaseURL: "https://nomoromosse-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "nomoromosse",
      storageBucket: "nomoromosse.firebasestorage.app",
      messagingSenderId: "985183830784",
      appId: "1:985183830784:web:fae21bdb94c1f0103769e5"
    };

    try {
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      window.firebaseReady = true;

      // Fungsi Firebase
      function simpanKeFirebase() {
        const ref = database.ref('fitur11').push();
        currentKey = ref.key;
        ref.set(currentData)
          .then(() => showStatus("✅ Tersimpan!", "success"))
          .catch(e => showStatus("❌ Gagal: " + e.message, "error"));
      }

      function hapusDariFirebase() {
        database.ref('fitur11/' + currentKey).remove()
          .then(() => {
            currentKey = null;
            currentData = null;
            document.getElementById('hasil').style.display = 'none';
            showStatus("Dihapus.", "success");
          })
          .catch(e => showStatus("Gagal hapus: " + e.message, "error"));
      }
    } catch (e) {
      console.warn("Firebase gagal inisialisasi:", e);
      window.firebaseReady = false;
    }
  </script>
</body>
</html>
