<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>kamar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 12px;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 16px;
    }

    h1 {
      text-align: center;
      font-size: 1.4em;
      margin: 0 0 20px;
      color: #333;
    }

    /* üîô Kembali ke Beranda */
    .back-home {
      text-align: center;
      margin: 12px 0;
    }
    .back-home a {
      display: inline-block;
      padding: 10px 20px;
      background: #4285f4;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 0.95em;
    }
    .back-home a:hover {
      background: #3367d6;
    }

    .input-group {
      margin: 12px 0;
    }

    label {
      display: block;
      font-weight: bold;
      margin-bottom: 6px;
      color: #555;
      font-size: 0.95em;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #673ab7;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      margin: 16px 0;
    }

    button:active {
      background: #512da8;
      transform: scale(0.99);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 16px;
    }

    th, td {
      padding: 12px 8px;
      text-align: center;
      border: 1px solid #ddd;
    }

    th {
      background-color: #f8f9fa;
      color: #333;
    }

    .rumus-tag {
      color: #d32f2f;
      font-weight: bold;
      font-size: 15px;
    }

    @media (max-width: 480px) {
      .container {
        padding: 12px;
      }
      th, td {
        padding: 10px 6px;
        font-size: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üî¢ kamar</h1>

    <!-- üîô Kembali ke Beranda -->
    <div class="back-home">
      <a href="index.html">üîô Kembali ke Beranda</a>
    </div>

    <div class="input-group">
      <label for="tanggalSebelum">Tanggal Pemutaran Sebelumnya</label>
      <input type="text" id="tanggalSebelum" placeholder="Contoh: 10" inputmode="numeric" />
    </div>

    <div class="input-group">
      <label for="tanggalSekarang">Tanggal Pemutaran Sekarang</label>
      <input type="text" id="tanggalSekarang" placeholder="Contoh: 11" inputmode="numeric" />
    </div>

    <div class="input-group">
      <label for="result4DLalu">4D Result Sebelumnya</label>
      <input type="text" id="result4DLalu" placeholder="Contoh: 4796" inputmode="numeric" maxlength="4" />
    </div>

    <div class="input-group">
      <label for="result4D">4D Result Sekarang</label>
      <input type="text" id="result4D" placeholder="Contoh: 7890" inputmode="numeric" maxlength="4" />
    </div>

    <button id="btn-hitung">Terapkan Semua Rumus</button>

    <table id="kamar-table">
      <thead>
        <tr>
          <th>Kamar</th>
          <th>Rumus Lemah</th>
        </tr>
      </thead>
      <tbody id="kamar-body">
        <!-- Diisi otomatis -->
      </tbody>
    </table>
  </div>

  <script>
    // üîÅ Tetap pakai shio internal (logika tidak berubah)
    const shioAngka = {
      1: [1,13,25,37,49,61,73,85,97],
      2: [2,14,26,38,50,62,74,86,98],
      3: [3,15,27,39,51,63,75,87,99],
      4: [4,16,28,40,52,64,76,88],
      5: [5,17,29,41,53,65,77,89],
      6: [6,18,30,42,54,66,78,90],
      7: [7,19,31,43,55,67,79,91],
      8: [8,20,32,44,56,68,80,92],
      9: [9,21,33,45,57,69,81,93],
      10: [10,22,34,46,58,70,82,94],
      11: [11,23,35,47,59,71,83,95],
      12: [12,24,36,48,60,72,84,96]
    };

    function buatTabelKamar() {
      const tbody = document.getElementById("kamar-body");
      tbody.innerHTML = "";
      for (let i = 1; i <= 12; i++) {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${i}</td><td id="rumus-${i}">‚Äî</td>`;
        tbody.appendChild(row);
      }
    }

    function getIndex(angka) {
      return (angka + 5) % 10;
    }

    function hitungDasar2D(duaD) {
      let total;
      if (duaD < 10) {
        total = 0 + duaD;
      } else {
        const str = duaD.toString();
        total = parseInt(str[0], 10) + parseInt(str[1], 10);
      }
      while (total >= 10) {
        total = String(total).split('').reduce((sum, digit) => sum + parseInt(digit, 10), 0);
      }
      return total === 0 ? 9 : total;
    }

    function angkaKeShio(n) {
      n = n % 12;
      return n === 0 ? 12 : n;
    }

    function hitungKamarLemah(tglSeb, tglSkr, empatDLalu, empatDSkr) {
      const kamarRumus = {};
      for (let i = 1; i <= 12; i++) {
        kamarRumus[i] = new Set();
      }

      let str4D = empatDSkr.toString().padStart(4, '0');
      const AS = parseInt(str4D[0], 10);
      const KOP = parseInt(str4D[1], 10);
      const KEPALA = parseInt(str4D[2], 10);
      const EKOR = parseInt(str4D[3], 10);
      const duaD = KEPALA * 10 + EKOR;

      // Rumus 1‚Äì13 (gunakan result SEKARANG)
      kamarRumus[angkaKeShio(tglSkr)].add(1);
      kamarRumus[angkaKeShio(tglSkr + 7)].add(2);
      kamarRumus[angkaKeShio(tglSeb + tglSkr)].add(3);
      kamarRumus[angkaKeShio(hitungDasar2D(duaD) + tglSkr)].add(4);
      kamarRumus[angkaKeShio(100 - duaD)].add(5);
      kamarRumus[angkaKeShio(99 - duaD)].add(6);

      const angka7 = getIndex(AS) * 10 + getIndex(KOP);
      kamarRumus[angkaKeShio(angka7)].add(7);

      const angka8 = getIndex(KEPALA) * 10 + getIndex(EKOR);
      kamarRumus[angkaKeShio(angka8)].add(8);

      kamarRumus[angkaKeShio(AS * 10 + KOP)].add(9);
      kamarRumus[angkaKeShio(KOP * 10 + KEPALA)].add(10);

      const digitKepala = KEPALA.toString();
      for (let s = 1; s <= 12; s++) {
        const list = shioAngka[s];
        let ada = false;
        for (let num of list) {
          if (num.toString().padStart(2, '0').includes(digitKepala)) {
            ada = true;
            break;
          }
        }
        if (!ada) kamarRumus[s].add(11);
      }

      const digitEkor = EKOR.toString();
      for (let s = 1; s <= 12; s++) {
        const list = shioAngka[s];
        let ada = false;
        for (let num of list) {
          if (num.toString().padStart(2, '0').includes(digitEkor)) {
            ada = true;
            break;
          }
        }
        if (!ada) kamarRumus[s].add(12);
      }

      const angka13 = AS * 10 + EKOR;
      kamarRumus[angkaKeShio(angka13)].add(13);

      // üîπ Rumus 14: index(AS_lalu) + index(AS_sekarang)
      let str4DLalu = empatDLalu.toString().padStart(4, '0');
      const AS_Lalu = parseInt(str4DLalu[0], 10);
      const idxLalu = getIndex(AS_Lalu);
      const idxSkr = getIndex(AS);
      const angka14 = idxLalu * 10 + idxSkr;
      kamarRumus[angkaKeShio(angka14)].add(14);

      return kamarRumus;
    }

    function tampilkanKamarLemah(kamarRumus) {
      for (let i = 1; i <= 12; i++) {
        const cell = document.getElementById(`rumus-${i}`);
        const list = Array.from(kamarRumus[i]).sort((a, b) => a - b);
        cell.innerHTML = list.length === 0 ? "‚Äî" : `<span class="rumus-tag">${list.join(",")}</span>`;
      }
    }

    document.getElementById("btn-hitung").addEventListener("click", () => {
      const seb = document.getElementById("tanggalSebelum").value.trim();
      const skr = document.getElementById("tanggalSekarang").value.trim();
      const laluStr = document.getElementById("result4DLalu").value.trim();
      const skr4DStr = document.getElementById("result4D").value.trim();

      if (!seb || !skr || !laluStr || !skr4DStr) {
        alert("Harap isi semua kolom.");
        return;
      }

      const tglSeb = parseInt(seb, 10);
      const tglSkr = parseInt(skr, 10);
      const empatDLalu = parseInt(laluStr, 10);
      const empatDSkr = parseInt(skr4DStr, 10);

      if (isNaN(tglSeb) || isNaN(tglSkr) || tglSeb < 1 || tglSeb > 31 || tglSkr < 1 || tglSkr > 31) {
        alert("Tanggal harus angka 1‚Äì31.");
        return;
      }

      if (isNaN(empatDLalu) || isNaN(empatDSkr) || empatDLalu < 0 || empatDLalu > 9999 || empatDSkr < 0 || empatDSkr > 9999) {
        alert("4D harus angka 0‚Äì9999.");
        return;
      }

      const hasil = hitungKamarLemah(tglSeb, tglSkr, empatDLalu, empatDSkr);
      tampilkanKamarLemah(hasil);
    });

    document.addEventListener("DOMContentLoaded", () => {
      buatTabelKamar();
    });
  </script>
</body>
</html>